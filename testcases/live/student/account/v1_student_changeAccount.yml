- config:
    name: 学生更换账号
    variables:
      curAccount: ${yml(student.account.account6)}
      newAccount: ${yml(student.account.account7)}
      existsAccount: ${yml(student.account.account1)}
      true_password: ${student.account.default_password}
      true_code: ${yml(student.account.default_auth_code)}
      wrongTypeAccount: asldfjawefals
      wrongFormatAccount: ${yml(student.account.non_exists_account)}
      wrongPwd: alfealkngaowe
      wrongTypeCode: alskjfelij
      wrongCode: 110120
      wrongLengthCode: 999999999999

- test:
    name: token错误
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: $true_password
      code: $true_code
      token: asdfaefaefa
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 703]
      - eq: [content.msg, accessToken error]

- test:
    name: 获取token
    testcase: testcases/live/student/account/student_get_token.yml
    variables:
      account: $curAccount
    output:
      - token

- test:
    name: 获取验证码（换账号用）
    api: api/live/student/account/v1_student_authCodeToNewPhone.yml
    variables:
      account: $newAccount
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]

- test:
    name: 新手机号已存在
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $existsAccount
      password: $true_password
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 605]
      - eq: [content.msg, 账户(手机号)已存在]

- test:
    name: 手机号格式错误
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $wrongFormatAccount
      password: $true_password
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]

- test:
    name: 手机号数据类型错误
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $wrongTypeAccount
      password: $true_password
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]

- test:
    name: 密码错误
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: $wrongPwd
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 603]
      - eq: [content.msg, 密码错误]

- test:
    name: 验证码错误
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: $true_password
      code: $wrongCode
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]

- test:
    name: 验证码长度超长
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: $true_password
      code: $wrongLengthCode
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]

- test:
    name: 验证码数据类型错误
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: $true_password
      code: $wrongTypeCode
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]

- test:
    name: 缺少手机号
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: null
      password: $true_password
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]

- test:
    name: 缺少密码
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: null
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]

- test:
    name: 缺少验证码
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: $true_password
      code: null
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]

- test:
    name: 学生更换账号
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $curAccount
      password: $true_password
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]

- test:
    name: 获取token
    testcase: testcases/live/student/account/student_get_token.yml
    variables:
      account: $newAccount
    output:
      - token

- test:
    name: 学生更换账号
    api: api/live/student/account/v1_student_changeAccount.yml
    variables:
      account: $newAccount
      password: $true_password
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]
