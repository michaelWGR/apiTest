- config:
    name: 学生更换账号V2
    variables:
      newAccount: ${yml(student.account.account8)}
      oldAccount: ${yml(student.account.account9)}
      pwd: ${yml(student.account.default_password)}
      true_code: ${yml(student.account.default_auth_code)}
      wrongPwd: alfealkngaowe
      wrongTypeCode: alskjfelij
      wrongCode: 110120
      wrongLengthCode: 999999999999

- test:
    name: get token1
    testcase: testcases/live/student/account/student_get_token.yml
    variables:
      account: $oldAccount
    output:
      - token

- test:
    name: 获取验证码1
    api: api/live/student/account/v1_student_authCodeToNewPhone.yml
    variables:
      account: $newAccount
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]

- test:
    name: 密码错误
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $newAccount
      password: $wrongPwd
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 420]
      - eq: [content.msg, 原密码错误]

- test:
    name: 验证码错误
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $newAccount
      password: $pwd
      code: $wrongCode
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]

- test:
    name: 验证码长度超长
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $newAccount
      password: $pwd
      code: $wrongLengthCode
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]

- test:
    name: 验证码数据类型错误
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $newAccount
      password: $pwd
      code: $wrongTypeCode
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]

- test:
    name: 缺少手机号
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: null
      password: $pwd
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]

- test:
    name: 缺少密码
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $newAccount
      password: null
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]

- test:
    name: 缺少验证码
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $newAccount
      password: $pwd
      code: null
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码过期或者不存在]

- test:
    name: 学生更换账号1
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $newAccount
      password: $pwd
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]

- test:
    name: get token2
    testcase: testcases/live/student/account/student_get_token.yml
    variables:
      account: $newAccount
    output:
      - token

- test:
    name: 获取验证码2
    api: api/live/student/account/v1_student_authCodeToNewPhone.yml
    variables:
      account: $oldAccount
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]

- test:
    name: 学生更换账号2
    api: api/live/student/account/v1_student_changeAccountV2.yml
    variables:
      account: $oldAccount
      password: $pwd
      code: $true_code
      token: $token
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]
