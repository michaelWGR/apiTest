- config:
    name: 短信验证码登录

- test:
    name: authCode
    testcase: testcases/live/student/account/v1_student_authCode.yml

- test:
    name: 短信验证码登录
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: ${yml(student.account.account1)}
      code: ${yml(student.account.default_auth_code)}
      deviceId: ${yml(student.default_device_id)}
    validate:
      - eq: [content.code, 200]
      - eq: [content.msg, ok]
      - eq: [content.success, true]

- test:
    name: 缺少必填参数
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: ${yml(student.account.account1)}
      code: null
      deviceId: ${yml(student.default_device_id)}
    validate:
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]
      - eq: [content.success, false]

- test:
    name: 不存在的账号
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: 13141599753
      code: ${yml(student.account.default_auth_code)}
      deviceId: ${yml(student.default_device_id)}
    validate:
      - eq: [content.code, 400]
      - eq: [content.msg, 参数错误]
      - eq: [content.success, false]

- test:
    name: 错误的验证码
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: ${yml(student.account.account1)}
      code: 111111
      deviceId: ${yml(student.default_device_id)}
    validate:
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码过期或者不存在]
      - eq: [content.success, false]

- test:
    name: 未生成验证码
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: ${yml(student.account.account1)}
      code: ${yml(student.account.default_auth_code)}
      deviceId: ${yml(student.default_device_id)}
    validate:
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码过期或者不存在]
      - eq: [content.success, false]