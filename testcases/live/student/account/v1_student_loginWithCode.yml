- config:
    name: 短信验证码登录
    variables:
      true_account: ${yml(student.account.login_with_code_account)}
      wrong_account: ${yml(student.account.non_exists_account)}
      wrong_code: 111111

- test:
    name: 未生成验证码
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: $true_account
      code: ${get_auth_code($true_account)}
    validate:
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]
      - eq: [content.success, false]

- test:
    name: 短信登录获取验证码
    api: api/live/student/account/v1_student_authCode.yml
    variables:
      account: $true_account
    validate:
      - eq: [status_code, 200]
      - eq: [content.code, 200]
      - eq: [content.msg, ok]
      - eq: [content.success, true]

- test:
    name: 短信验证码登录
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: $true_account
      code: ${get_auth_code($true_account)}
    validate:
      - eq: [content.code, 200]
      - eq: [content.msg, ok]
      - eq: [content.success, true]

- test:
    name: 不存在的账号
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: $wrong_account
      code: ${get_auth_code($wrong_account)}
    validate:
      - eq: [content.code, 601]
      - eq: [content.msg, 该账号不存在]
      - eq: [content.success, false]

- test:
    name: 错误的验证码
    api: api/live/student/account/v1_student_loginWithCode.yml
    variables:
      account: $true_account
      code: $wrong_code
    validate:
      - eq: [content.code, 604]
      - eq: [content.msg, 验证码错误或超时]
      - eq: [content.success, false]
