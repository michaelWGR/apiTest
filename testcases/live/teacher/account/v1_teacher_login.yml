- config:
    name: teacher login to live
    variables:
        true_account: ${yml(teacher_account1)}
        true_password: ${yml(teacher_password1)}
        true_deviceId: "123456"
        true_user_id: ${yml(teacher_user_id1)}

- test:
    name: login successfully
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: $true_account
        password: $true_password
        deviceId: $true_deviceId
    validate:
        - eq: [content.code, 200]
        - eq: [content.msg, ok]
        - eq: [content.success, true]
        - type_match: [content.data, dict]
        - eq: [content.data.userId, $true_user_id]
        - len_eq: [content.data.accessToken, 220]
        - type_match: [content.data.accessTokenExpire, int]
        - len_eq: [content.data.refreshToken, 40]
        - type_match: [content.data.refreshTokenExpire, int]
        - contains: [content.data, nickName]

- test:
    name: login failure with wrong account
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: wrongaccount
        password: $true_password
        deviceId: $true_deviceId
    validate:
        - eq: [content.code, 601]
        - eq: [content.msg, 该账号不存在]
        - eq: [content.data, null]
        - eq: [content.success, false]

- test:
    name: login failure with empty account
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: null
        password: $true_password
        deviceId: $true_deviceId
    validate:
        - eq: [content.code, 603]
        - eq: [content.msg, 密码错误]
        - eq: [content.data, null]
        - eq: [content.success, false]

- test:
    name: login failure with account of special characters
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: '%$#*&12345'
        password: $true_password
        deviceId: $true_deviceId
    validate:
        - eq: [content.code, 601]
        - eq: [content.msg, 该账号不存在]
        - eq: [content.data, null]
        - eq: [content.success, false]

- test:
    name: login failure with wrong password
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: ${yml(teacher_account1)}
        password: wrongpassword
        deviceId: $true_deviceId
    validate:
        - eq: [content.code, 603]
        - eq: [content.msg, 密码错误]
        - eq: [content.data, null]
        - eq: [content.success, false]

- test:
    name: login failure with empty password
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: ${yml(teacher_account1)}
        password: null
        deviceId: $true_deviceId
    validate:
        - eq: [content.code, 603]
        - eq: [content.msg, 密码错误]
        - eq: [content.data, null]
        - eq: [content.success, false]

- test:
    name: login failure with password of special characters
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: ${yml(teacher_account1)}
        password: '%$#*&12345'
        deviceId: $true_deviceId
    validate:
        - eq: [content.code, 603]
        - eq: [content.msg, 密码错误]
        - eq: [content.data, null]
        - eq: [content.success, false]

- test:
    name: login successfully with wrong device id
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: $true_account
        password: $true_password
        deviceId: wrongid
    validate:
        - eq: [content.code, 200]
        - eq: [content.msg, ok]
        - eq: [content.success, true]
        - type_match: [content.data, dict]
        - eq: [content.data.userId, $true_user_id]
        - len_eq: [content.data.accessToken, 220]
        - type_match: [content.data.accessTokenExpire, int]
        - len_eq: [content.data.refreshToken, 40]
        - type_match: [content.data.refreshTokenExpire, int]
        - contains: [content.data, nickName]

- test:
    name: login successfully with empty device id
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: $true_account
        password: $true_password
        deviceId: null
    validate:
        - eq: [content.code, 200]
        - eq: [content.msg, ok]
        - eq: [content.success, true]
        - type_match: [content.data, dict]
        - eq: [content.data.userId, $true_user_id]
        - len_eq: [content.data.accessToken, 188]
        - type_match: [content.data.accessTokenExpire, int]
        - len_eq: [content.data.refreshToken, 40]
        - type_match: [content.data.refreshTokenExpire, int]
        - contains: [content.data, nickName]

- test:
    name: login successfully with device id of special characters
    api: api/live/teacher/account/v1_teacher_login.yml
    variables:
        account: $true_account
        password: $true_password
        deviceId: '1%$#*&$123456'
    validate:
        - eq: [content.code, 200]
        - eq: [content.msg, ok]
        - eq: [content.success, true]
        - type_match: [content.data, dict]
        - eq: [content.data.userId, $true_user_id]
        - len_eq: [content.data.accessToken, 220]
        - type_match: [content.data.accessTokenExpire, int]
        - len_eq: [content.data.refreshToken, 40]
        - type_match: [content.data.refreshTokenExpire, int]
        - contains: [content.data, nickName]